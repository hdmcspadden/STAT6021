abline(h=0,col="red")
# 0-filtered
plot(cornnitFilteredModel$fitted.values,cornnitFilteredModel$residuals, main="MANY TRANSFORMATIONS")
abline(h=0,col="red")
par(mfrow=c(1,3))
# Original data set residual plot
plot(cornModel$fitted.values,cornModel$residuals, main="ORIGINAL")
abline(h=0,col="red")
# 1/x (1/y)^-2
plot(cornModel.secondyinvx$fitted.values,cornModel.secondyinvx$residuals, main="MANY TRANSFORMATIONS")
abline(h=0,col="red")
# 0-filtered
plot(cornnitFilteredModel$fitted.values,cornnitFilteredModel$residuals, main="0 filtered")
abline(h=0,col="red")
par(mfrow=c(1,3))
# Original ACF
acf(cornModel$residuals, main="ORIGINAL")
# 1/x (1/y)^-2 ACF
acf(cornModel.secondyinvx$residuals, main="ORIGINAL")
# 0-filtered ACF
acf(cornnitFilteredModel$residuals, main="0 Filtered")
summary(cornnitFilteredModel)
summary(cornModel.secondyinvx)
summary(cornnitFilteredModel)
setwd("~/UVaCode/R/STAT6021/Exams/Exam1")
library(MASS)
road
library(MASS)
head(road)
attach(road)
roadModel = lm(deaths~drivers) # estimated simple linear regression model of y (deaths) vs. x (drivers)
roadModel
summary(roadModel) # print the model summary
qt(0.975,24)
qt(0.975,8)
qt(0.975,24)
anova(roadModel)
talpha2 = qt(0.975,24)
talpha2 = qt(0.975,24)
talpha2
talpha2 = qt(0.975,24)
#talpha2 = 2.0639
b1hat = 4.595
seB1hat = .2897
lowCI = b1hat - (talpha2 * seB1hat)
highCI = b1hat + (talpha2 * seB1hat)
print(paste("The 95% CI for the population slope of the regression line is: ", lowCI, " - ", highCI))
confint(roadModel, level = 0.95)
criticalValue = qt(0.975,24)
criticalValue
attach(road)
roadModel = lm(formula = deaths~drivers) # estimated simple linear regression model of y (deaths) vs. x (drivers)
roadModel
ei-var = 5.914^2
eivar = 5.914^2
eivar
exp(1.50792)
(exp(0.44993) - 1) * 100
34.9754 / (.3148)^2
10.7296 * 34.9754
4026.5195 + 9443.358
34.9754 / (.3148)^2
4026.5195 / 34.9754
t0 = (10.7296 - 10) / .3148
t0
critvalueq2c = qt(.95,270)
critvalueq2c
critvalueq2c = qt(.975,270)
critvalueq2c
critvalueq2c = qt(.95,270)
critvalueq2c
34.9754 + (10.7296^2 * 352.9338)
34.9754 + (10.7296 * 352.9338)
34.9754 + (10.7296^2 * 352.9338)
(exp(-0.44993) - 1) * 100
# y' = y^2
yield2 <- yield^2
cornModel.yield2 <-lm(yield2~nitrogen)
par(mfrow=c(2,1))
# scatter plot transformed y
plot(x=nitrogen, y=yield2, main='Scatter Plot y^2 Trans', xlab = 'Nitrogen (lbs per acre)', ylab = 'Yield^2')
abline(cornModel,col="red")
#residual plot of transformed y
plot(cornModel.yield2$fitted.values,cornModel.yield2$residuals, main="Residual Plot: y^2")
abline(h=0,col="red")
# y' = y^2
yield2 <- yield^2
cornModel.yield2 <-lm(yield2~nitrogen)
par(mfrow=c(1,2))
# scatter plot transformed y
plot(x=nitrogen, y=yield2, main='Scatter Plot y^2 Trans', xlab = 'Nitrogen (lbs per acre)', ylab = 'Yield^2')
abline(cornModel,col="red")
#residual plot of transformed y
plot(cornModel.yield2$fitted.values,cornModel.yield2$residuals, main="Residual Plot: y^2")
abline(h=0,col="red")
# y' = y^2
yield2 <- yield^2
cornModel.yield2 <-lm(yield2~nitrogen)
par(mfrow=c(1,2))
# scatter plot transformed y
plot(x=nitrogen, y=yield2, main='Scatter Plot y^2 Trans', xlab = 'Nitrogen (lbs per acre)', ylab = 'Yield^2')
abline(cornModel.yield2,col="red")
#residual plot of transformed y
plot(cornModel.yield2$fitted.values,cornModel.yield2$residuals, main="Residual Plot: y^2")
abline(h=0,col="red")
# y' = y^2
yield2 <- yield^2
cornModel.yield2 <-lm(yield2~nitrogen)
par(mfrow=c(2,2))
# scatter plot transformed y
plot(x=nitrogen, y=yield2, main='Scatter Plot y^2 Trans', xlab = 'Nitrogen (lbs per acre)', ylab = 'Yield^2')
abline(cornModel.yield2,col="red")
#residual plot of transformed y
plot(cornModel.yield2$fitted.values,cornModel.yield2$residuals, main="Residual Plot: y^2")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.yield2, lambda = seq(1.4, 4.5, 0.01))
# y' = y^2
yield2 <- yield^2
cornModel.yield2 <-lm(yield2~nitrogen)
par(mfrow=c(2,2))
# scatter plot transformed y
plot(x=nitrogen, y=yield2, main='Scatter Plot y^2 Trans', xlab = 'Nitrogen (lbs per acre)', ylab = 'Yield^2')
abline(cornModel.yield2,col="red")
#residual plot of transformed y
plot(cornModel.yield2$fitted.values,cornModel.yield2$residuals, main="Residual Plot: y^2")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.yield2, lambda = seq(-2, 2.5, 0.01))
# y' = y^2
yield2 <- yield^2
cornModel.yield2 <-lm(yield2~nitrogen)
par(mfrow=c(2,2))
# scatter plot transformed y
plot(x=nitrogen, y=yield2, main='Scatter Plot y^2 Trans', xlab = 'Nitrogen (lbs per acre)', ylab = 'Yield^2')
abline(cornModel.yield2,col="red")
#residual plot of transformed y
plot(cornModel.yield2$fitted.values,cornModel.yield2$residuals, main="Residual Plot: y^2")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.yield2, lambda = seq(0, 2.5, 0.01))
# y' = y^2
yield2 <- yield^2
cornModel.yield2 <-lm(yield2~nitrogen)
par(mfrow=c(2,2))
# scatter plot transformed y
plot(x=nitrogen, y=yield2, main='Scatter Plot y^2 Trans', xlab = 'Nitrogen (lbs per acre)', ylab = 'Yield^2')
abline(cornModel.yield2,col="red")
#residual plot of transformed y
plot(cornModel.yield2$fitted.values,cornModel.yield2$residuals, main="Residual Plot: y^2")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.yield2, lambda = seq(0.5, 2.5, 0.01))
# y' = y^2
yield2 <- yield^2
cornModel.yield2 <-lm(yield2~nitrogen)
par(mfrow=c(2,2))
# scatter plot transformed y
plot(x=nitrogen, y=yield2, main='Scatter Plot y^2 Trans', xlab = 'Nitrogen (lbs per acre)', ylab = 'Yield^2')
abline(cornModel.yield2,col="red")
#residual plot of transformed y
plot(cornModel.yield2$fitted.values,cornModel.yield2$residuals, main="Residual Plot: y^2")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.yield2, lambda = seq(0.5, 2.5, 0.01))
#QQ plot
qqnorm(cornModel.yield2$residuals)
qqline(cornModel.yield2$residuals, col="red")
# y' = y^2
yield2 <- yield^2
cornModel.yield2 <-lm(yield2~nitrogen)
par(mfrow=c(3,2)) # 3 rows, 2 columns
# scatter plot transformed y
plot(x=nitrogen, y=yield2, main='Scatter Plot y^2 Trans', xlab = 'Nitrogen (lbs per acre)', ylab = 'Yield^2')
abline(cornModel.yield2,col="red")
#residual plot of transformed y
plot(cornModel.yield2$fitted.values,cornModel.yield2$residuals, main="Residual Plot: y^2")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.yield2, lambda = seq(0.5, 2.5, 0.01))
#QQ plot
qqnorm(cornModel.yield2$residuals)
qqline(cornModel.yield2$residuals, col="red")
#ACF plot
acf(cornModel.yield2$residuals, main="ACF of Residuals: y^2")
#x' = (x + ((min(x)/2)))
minimumNonZeroNit = min(nitrogen[nitrogen > 0])
inv.nitrogen = 1 / (nitrogen + (minimumNonZeroNit /2))
cornModel.yield2.invx <-lm(yield2~inv.nitrogen)
par(mfrow=c(3,2)) # 3 rows, 2 columns
# scatter plot yield2, invx
plot(x=inv.nitrogen, y=yield2, main='Scatter Plot y^2 1/x', xlab = '1/Nitrogen', ylab = 'Yield^2')
abline(cornModel.yield2,col="red")
#residual plot yield2, invx
plot(cornModel.yield2.invx$fitted.values,cornModel.yield2.invx$residuals, main="Residual Plot: y^2 1/x")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.yield2.invx, lambda = seq(0.5, 2.5, 0.01))
#QQ plot
qqnorm(cornModel.yield2.invx$residuals)
qqline(cornModel.yield2.invx$residuals, col="red")
#ACF plot
acf(cornModel.yield2.invx$residuals, main="ACF of Residuals: y^2 1/x")
# y' = y^2
yield2 <- yield^2
cornModel.yield2 <-lm(yield2~nitrogen)
par(mfrow=c(1,2)) # 1 rows, 2 columns - there will be three panes to look through
# scatter plot transformed y
plot(x=nitrogen, y=yield2, main='Scatter Plot y^2 Trans', xlab = 'Nitrogen (lbs per acre)', ylab = 'Yield^2')
abline(cornModel.yield2,col="red")
#residual plot of transformed y
plot(cornModel.yield2$fitted.values,cornModel.yield2$residuals, main="Residual Plot: y^2")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.yield2, lambda = seq(0.5, 2.5, 0.01))
#QQ plot
qqnorm(cornModel.yield2$residuals)
qqline(cornModel.yield2$residuals, col="red")
#ACF plot
acf(cornModel.yield2$residuals, main="ACF of Residuals: y^2")
#x' = (x + ((min(x)/2)))
minimumNonZeroNit = min(nitrogen[nitrogen > 0])
inv.nitrogen = 1 / (nitrogen + (minimumNonZeroNit /2))
cornModel.yield2.invx <-lm(yield2~inv.nitrogen)
par(mfrow=c(1,2)) # 1 rows, 2 columns - there will be three panes to look through
# scatter plot yield2, invx
plot(x=inv.nitrogen, y=yield2, main='Scatter Plot y^2 1/x', xlab = '1/Nitrogen', ylab = 'Yield^2')
abline(cornModel.yield2,col="red")
#residual plot yield2, invx
plot(cornModel.yield2.invx$fitted.values,cornModel.yield2.invx$residuals, main="Residual Plot: y^2 1/x")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.yield2.invx, lambda = seq(0.5, 2.5, 0.01))
#QQ plot
qqnorm(cornModel.yield2.invx$residuals)
qqline(cornModel.yield2.invx$residuals, col="red")
#ACF plot
acf(cornModel.yield2.invx$residuals, main="ACF of Residuals: y^2 1/x")
detach(cornnit)
attach(cornnitFiltered)
yield2.filtered = yield^2 # square the filtered y
inv.nitrogen.filtered = 1/nitrogen
cornModel.filtered.yield2.invx <-lm(yield2.filtered~inv.nitrogen.filtered)
par(mfrow=c(1,2)) # 1 rows, 2 columns - there will be three panes to look through
# scatter plot filtered yield2, invx
plot(x=inv.nitrogen.filtered, y=yield2.filtered, main='Scatter Plot Filtered y^2 1/x', xlab = '1/Nitrogen', ylab = 'Yield^2')
abline(cornModel.yield2,col="red")
#residual plot filtered yield2, invx
plot(cornModel.filtered.yield2.invx$fitted.values,cornModel.filtered.yield2.invx$residuals, main="Residual Plot: filtered y^2 1/x")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.filtered.yield2.invx, lambda = seq(0.5, 2.5, 0.01))
#QQ plot
qqnorm(cornModel.filtered.yield2.invx$residuals)
qqline(cornModel.filtered.yield2.invx$residuals, col="red")
#ACF plot
acf(cornModel.filtered.yield2.invx$residuals, main="ACF of Residuals: y^2 1/x")
detach(cornnit)
attach(cornnitFiltered)
yield2.filtered = yield^2 # square the filtered y
inv.nitrogen.filtered = 1/nitrogen
cornModel.filtered.yield2.invx <-lm(yield2.filtered~inv.nitrogen.filtered)
par(mfrow=c(1,2)) # 1 rows, 2 columns - there will be three panes to look through
# scatter plot filtered yield2, invx
plot(x=inv.nitrogen.filtered, y=yield2.filtered, main='Scatter Plot Filtered y^2 1/x', xlab = '1/Nitrogen', ylab = 'Yield^2')
abline(cornModel.filtered.yield2.invx,col="red")
#residual plot filtered yield2, invx
plot(cornModel.filtered.yield2.invx$fitted.values,cornModel.filtered.yield2.invx$residuals, main="Residual Plot: filtered y^2 1/x")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.filtered.yield2.invx, lambda = seq(0.5, 2.5, 0.01))
#QQ plot
qqnorm(cornModel.filtered.yield2.invx$residuals)
qqline(cornModel.filtered.yield2.invx$residuals, col="red")
#ACF plot
acf(cornModel.filtered.yield2.invx$residuals, main="ACF of Residuals: y^2 1/x")
detach(cornnit)
attach(cornnitFiltered)
yield2.filtered = yield^2 # square the filtered y
inv.nitrogen.filtered = 1/nitrogen
cornModel.filtered.yield2.invx <-lm(yield2.filtered~inv.nitrogen.filtered)
par(mfrow=c(1,2)) # 1 rows, 2 columns - there will be three panes to look through
# scatter plot filtered yield2, invx
plot(x=inv.nitrogen.filtered, y=yield2.filtered, main='Scatter Plot Filtered y^2 1/x', xlab = '1/Nitrogen', ylab = 'Yield^2')
abline(cornModel.filtered.yield2.invx,col="red")
#residual plot filtered yield2, invx
plot(cornModel.filtered.yield2.invx$fitted.values,cornModel.filtered.yield2.invx$residuals, main="Residual Plot: filtered y^2 1/x")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.filtered.yield2.invx, lambda = seq(-0.5, 2.5, 0.01))
#QQ plot
qqnorm(cornModel.filtered.yield2.invx$residuals)
qqline(cornModel.filtered.yield2.invx$residuals, col="red")
#ACF plot
acf(cornModel.filtered.yield2.invx$residuals, main="ACF of Residuals: y^2 1/x")
summary(cornModel.filtered.yield2.invx)
detach(cornnit)
attach(cornnitFiltered)
yield2.filtered = yield^2 # square the filtered y
inv.nitrogen.filtered = sqrt(nitrogen)
cornModel.filtered.yield2.invx <-lm(yield2.filtered~inv.nitrogen.filtered)
par(mfrow=c(1,2)) # 1 rows, 2 columns - there will be three panes to look through
# scatter plot filtered yield2, invx
plot(x=inv.nitrogen.filtered, y=yield2.filtered, main='Scatter Plot Filtered y^2 1/x', xlab = '1/Nitrogen', ylab = 'Yield^2')
abline(cornModel.filtered.yield2.invx,col="red")
#residual plot filtered yield2, invx
plot(cornModel.filtered.yield2.invx$fitted.values,cornModel.filtered.yield2.invx$residuals, main="Residual Plot: filtered y^2 1/x")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.filtered.yield2.invx, lambda = seq(-0.5, 2.5, 0.01))
#QQ plot
qqnorm(cornModel.filtered.yield2.invx$residuals)
qqline(cornModel.filtered.yield2.invx$residuals, col="red")
#ACF plot
acf(cornModel.filtered.yield2.invx$residuals, main="ACF of Residuals: y^2 1/x")
library(faraway)
#summary(cornnit)
head(cornnit, 5)
attach(cornnit)
cornnit
# create a model
cornModel <- lm(yield~nitrogen)
#plot the model and the linear model
plot(x=nitrogen, y=yield, main='Plot Corn Yield Against Nitrogen', xlab = 'Nitrogen (lbs per acre)', ylab = 'Yield (bushels per acre')
abline(cornModel,col="red")
plot(cornModel$fitted.values,cornModel$residuals, main="Plot of Residuals against Fitted Values")
abline(h=0,col="red")
library(MASS)
#boxcox(cornModel)
boxcox(cornModel, lambda = seq(1.4, 4.5, 0.01))
# y' = y^2
yield2 <- yield^2
cornModel.yield2 <-lm(yield2~nitrogen)
par(mfrow=c(1,2)) # 1 rows, 2 columns - there will be three panes to look through
# scatter plot transformed y
plot(x=nitrogen, y=yield2, main='Scatter Plot y^2 Trans', xlab = 'Nitrogen (lbs per acre)', ylab = 'Yield^2')
abline(cornModel.yield2,col="red")
#residual plot of transformed y
plot(cornModel.yield2$fitted.values,cornModel.yield2$residuals, main="Residual Plot: y^2")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.yield2, lambda = seq(0.5, 2.5, 0.01))
#QQ plot
qqnorm(cornModel.yield2$residuals)
qqline(cornModel.yield2$residuals, col="red")
#ACF plot
acf(cornModel.yield2$residuals, main="ACF of Residuals: y^2")
#x' = sqrt(x)
sqrt.nitrogen = sqrt(nitrogen)
cornModel.yield2.sqrtx <-lm(yield2~sqrt.nitrogen)
par(mfrow=c(1,2)) # 1 rows, 2 columns - there will be three panes to look through
# scatter plot yield2, sqrt(x)
plot(x=sqrt.nitrogen, y=yield2, main='Scatter Plot y^2 sqrt(x)', xlab = 'sqrt(nitrogen)', ylab = 'Yield^2')
abline(cornModel.yield2.sqrtx,col="red")
#residual plot yield2, sqrt(x)
plot(cornModel.yield2.sqrtx$fitted.values,cornModel.yield2.sqrtx$residuals, main="Residual Plot: y^2 sqrt(x)")
abline(h=0,col="red")
# boxcox of y^2 model, sqrt(x)
boxcox(cornModel.yield2.sqrtx, lambda = seq(0.5, 2.5, 0.01))
#QQ plot of y^2 model, sqrt(x)
qqnorm(cornModel.yield2.sqrtx$residuals)
qqline(cornModel.yield2.sqrtx$residuals, col="red")
#ACF plot of y^2 model, sqrt(x)
acf(cornModel.yield2.sqrtx$residuals, main="ACF of Residuals: y^2 sqrt(x)")
#head(cornnit)
cornnitFiltered = cornnit[cornnit[, "nitrogen"]>0, ]
detach(cornnit)
attach(cornnitFiltered)
yield2.filtered = yield^2 # square the filtered y
inv.nitrogen.filtered = sqrt(nitrogen)
cornModel.filtered.yield2.invx <-lm(yield2.filtered~inv.nitrogen.filtered)
par(mfrow=c(1,2)) # 1 rows, 2 columns - there will be three panes to look through
# scatter plot filtered yield2, invx
plot(x=inv.nitrogen.filtered, y=yield2.filtered, main='Scatter Plot Filtered y^2 1/x', xlab = '1/Nitrogen', ylab = 'Yield^2')
abline(cornModel.filtered.yield2.invx,col="red")
#residual plot filtered yield2, invx
plot(cornModel.filtered.yield2.invx$fitted.values,cornModel.filtered.yield2.invx$residuals, main="Residual Plot: filtered y^2 1/x")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.filtered.yield2.invx, lambda = seq(-0.5, 2.5, 0.01))
#QQ plot
qqnorm(cornModel.filtered.yield2.invx$residuals)
qqline(cornModel.filtered.yield2.invx$residuals, col="red")
#ACF plot
acf(cornModel.filtered.yield2.invx$residuals, main="ACF of Residuals: y^2 1/x")
summary(cornModel.filtered.yield2.invx)
par(mfrow=c(1,1))
boxcox(cornnitFilteredModel, lambda = seq(-2, 5, 0.01))
par(mfrow=c(1,3))
# Original data set residual plot
plot(cornModel$fitted.values,cornModel$residuals, main="ORIGINAL")
abline(h=0,col="red")
# 1/x (1/y)^-2
plot(cornModel.secondyinvx$fitted.values,cornModel.secondyinvx$residuals, main="MANY TRANSFORMATIONS")
abline(h=0,col="red")
# 0-filtered
plot(cornnitFilteredModel$fitted.values,cornnitFilteredModel$residuals, main="0 filtered")
abline(h=0,col="red")
par(mfrow=c(1,3))
# Original ACF
acf(cornModel$residuals, main="ORIGINAL")
# 1/x (1/y)^-2 ACF
acf(cornModel.secondyinvx$residuals, main="ORIGINAL")
# 0-filtered ACF
acf(cornnitFilteredModel$residuals, main="0 Filtered")
summary(cornModel.secondyinvx)
summary(cornnitFilteredModel)
(exp(-0.44993) - 1) * 100
exp(1.50792)
detach(cornnit)
library(faraway)
#summary(cornnit)
head(cornnit, 5)
attach(cornnit)
cornnit
# create a model
cornModel <- lm(yield~nitrogen)
#plot the model and the linear model
plot(x=nitrogen, y=yield, main='Plot Corn Yield Against Nitrogen', xlab = 'Nitrogen (lbs per acre)', ylab = 'Yield (bushels per acre')
abline(cornModel,col="red")
plot(cornModel$fitted.values,cornModel$residuals, main="Plot of Residuals against Fitted Values")
abline(h=0,col="red")
library(MASS)
#boxcox(cornModel)
boxcox(cornModel, lambda = seq(1.4, 4.5, 0.01))
# y' = y^2
yield2 <- yield^2
cornModel.yield2 <-lm(yield2~nitrogen)
par(mfrow=c(1,2)) # 1 rows, 2 columns - there will be three panes to look through
# scatter plot transformed y
plot(x=nitrogen, y=yield2, main='Scatter Plot y^2 Trans', xlab = 'Nitrogen (lbs per acre)', ylab = 'Yield^2')
abline(cornModel.yield2,col="red")
#residual plot of transformed y
plot(cornModel.yield2$fitted.values,cornModel.yield2$residuals, main="Residual Plot: y^2")
abline(h=0,col="red")
# boxcox of y^2 model
boxcox(cornModel.yield2, lambda = seq(0.5, 2.5, 0.01))
#QQ plot
qqnorm(cornModel.yield2$residuals)
qqline(cornModel.yield2$residuals, col="red")
#ACF plot
acf(cornModel.yield2$residuals, main="ACF of Residuals: y^2")
#x' = sqrt(x)
sqrt.nitrogen = sqrt(nitrogen)
cornModel.yield2.sqrtx <-lm(yield2~sqrt.nitrogen)
par(mfrow=c(1,2)) # 1 rows, 2 columns - there will be three panes to look through
# scatter plot yield2, sqrt(x)
plot(x=sqrt.nitrogen, y=yield2, main='Scatter Plot y^2 sqrt(x)', xlab = 'sqrt(nitrogen)', ylab = 'Yield^2')
abline(cornModel.yield2.sqrtx,col="red")
#residual plot yield2, sqrt(x)
plot(cornModel.yield2.sqrtx$fitted.values,cornModel.yield2.sqrtx$residuals, main="Residual Plot: y^2 sqrt(x)")
abline(h=0,col="red")
# boxcox of y^2 model, sqrt(x)
boxcox(cornModel.yield2.sqrtx, lambda = seq(0.5, 2.5, 0.01))
#QQ plot of y^2 model, sqrt(x)
qqnorm(cornModel.yield2.sqrtx$residuals)
qqline(cornModel.yield2.sqrtx$residuals, col="red")
#ACF plot of y^2 model, sqrt(x)
acf(cornModel.yield2.sqrtx$residuals, main="ACF of Residuals: y^2 sqrt(x)")
#head(cornnit)
cornnitFiltered = cornnit[cornnit[, "nitrogen"]>0, ]
detach(cornnit)
attach(cornnitFiltered)
yield2.filtered = yield^2 # square the filtered y
sqrt.nitrogen.filtered = sqrt(nitrogen)
cornModel.filtered.yield2.sqrtx <-lm(yield2.filtered~sqrt.nitrogen.filtered)
par(mfrow=c(1,2)) # 1 rows, 2 columns - there will be three panes to look through
# scatter plot filtered yield2, invx
plot(x=sqrt.nitrogen.filtered, y=yield2.filtered, main='Scatter Plot Filtered y^2 sqrt(x)', xlab = 'sqrt(nitrogen)', ylab = 'Yield^2')
abline(cornModel.filtered.yield2.sqrtx,col="red")
#residual plot filtered yield2, invx
plot(cornModel.filtered.yield2.sqrtx$fitted.values,cornModel.filtered.yield2.sqrtx$residuals, main="Residual Plot: filtered y^2 sqrt(x)")
abline(h=0,col="red")
# boxcox of filtered y^2 sqrt(x) model
boxcox(cornModel.filtered.yield2.sqrtx, lambda = seq(-0.5, 2.5, 0.01))
#QQ plot of filtered y^2 sqrt(x) model
qqnorm(cornModel.filtered.yield2.sqrtx$residuals)
qqline(cornModel.filtered.yield2.sqrtx$residuals, col="red")
#ACF plot
acf(cornModel.filtered.yield2.sqrtx$residuals, main="ACF of Residuals: Filtered y^2 sqrt(x)")
summary(cornModel.filtered.yield2.invx)
par(mfrow=c(1,1))
boxcox(cornnitFilteredModel, lambda = seq(-2, 5, 0.01))
par(mfrow=c(1,3))
# Original data set residual plot
plot(cornModel$fitted.values,cornModel$residuals, main="ORIGINAL")
abline(h=0,col="red")
# 1/x (1/y)^-2
plot(cornModel.secondyinvx$fitted.values,cornModel.secondyinvx$residuals, main="MANY TRANSFORMATIONS")
abline(h=0,col="red")
# 0-filtered
plot(cornnitFilteredModel$fitted.values,cornnitFilteredModel$residuals, main="0 filtered")
abline(h=0,col="red")
par(mfrow=c(1,3))
# Original ACF
acf(cornModel$residuals, main="ORIGINAL")
# 1/x (1/y)^-2 ACF
acf(cornModel.secondyinvx$residuals, main="ORIGINAL")
# 0-filtered ACF
acf(cornnitFilteredModel$residuals, main="0 Filtered")
summary(cornModel.secondyinvx)
summary(cornnitFilteredModel)
(exp(-0.44993) - 1) * 100
exp(1.50792)
summary(cornModel.filtered.yield2.sqrtx)
anova(cornModel.filtered.yield2.sqrtx)
anova(cornModel.filtered.yield2.sqrtx)
anova(cornModel.yield2.sqrtx)
summary(cornModel.filtered.yield2.sqrtx)
anova(cornModel.filtered.yield2.sqrtx)
summary(cornModel.yield2.sqrtx)
anova(cornModel.yield2.sqrtx)
