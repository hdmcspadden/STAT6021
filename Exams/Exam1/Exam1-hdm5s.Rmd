---
title: 'Exam 1: Modules 0 - 3'
author: "Diana McSpadden"
date: "9/18/2020"
output: html_document
---

# Question 1. (Use R) Load the \road" dataset from the MASS package in R. 
The data set contains the annual deaths in road accidents for a number of US states. The variables are:

* deaths: number of deaths in road accidents

* drivers: number of drivers (in 10,000s)

* popden: population density in people per square mile

* rural: length of rural roads, in 1000s of miles

* temp: average daily maximum temperature in January

* fuel: fuel consumption in 10,000,000 US gallons per year

A client wishes to explore the relationship between number of deaths (Y) and the
number of drivers (X). Fit an appropriate linear regression model yi = B0 + B1xi +
ei; where ei are i.i.d. N(0; sigma2). For the rest of the question, assume the regression
assumptions are met.

## (a) Report the estimated regression equation. 
## What is the interpretation of the estimated slope, in context? (5)

```{r q1a1}
library(MASS)

head(road)
```
```{r q1a2}
attach(road)

roadModel = lm(formula = deaths~drivers) # estimated simple linear regression model of y (deaths) vs. x (drivers) 

roadModel

```
### Answer 1a

E(y|x) = 122.009 + 4.595(x)

My interpretation of the slope, B1 = 4.595, is that **for each additional driver there is an increase of 4.595 deaths.**


## (b) Is the number of deaths in road accidents linearly related to the number of drivers?

Report the values of the test statistic and p-value from the corresponding hypothesis test from the output (do not need to show calculation), and state a conclusion in context at 0.05 significance level. (4)

```{r q1b1}
summary(roadModel) # print the model summary
```

```{r}
criticalValue = qt(0.975,24)
criticalValue
```


### Answer 1b

The test statistic is **1.551** which is not greater than the criticalValue: 2.0639, and our model has a p-value of **0.134** which is not less than a 0.05 significance level. This model does not reject our null hypothesis.

## (c) Use R to derive the 95% confidence interval for the population slope of the regression line. 

What does the interval tell us regarding the linear association between the number of deaths in road accidents and the number of drivers? (4)

**q1c work**

Equation for CI for B1-hat: B1-hat +- (t-alpha/2, (n-2))(se(B1-hat))

se(B1-hat) = 0.2897

t-(.975,8) = 

```{r q1c1}
talpha2 = qt(0.975,24)
#talpha2 = 2.0639

b1hat = 4.595

seB1hat = .2897

lowCI = b1hat - (talpha2 * seB1hat)

highCI = b1hat + (talpha2 * seB1hat)

print(paste("The 95% CI for the population slope of the regression line is: ", lowCI, " - ", highCI))

```

Another way to calculate the 95% CI of the slope is:

```{r}
confint(roadModel, level = 0.95)
```
Both methods produce the similar confidence interval.

### Answer 1c

We are 95% confidence that in the population there is an increase between **3.997 and 5.193** in the number of deaths with each additional driver.


## (d) Based on your answers in the previous two parts, 

Briefly explain whether or not your conclusions are consistent with each other. (3)

### Answer 1d
Because the t-value  is not greater than the critical value, I do not have 95% confidence in the interval of the population slope. They conclusions are consistent in that B1-hat is within the 95% CI of the population slope, but because the t-value does not meet our alpha criteria, our model does not meet our criteria.


##(e) Be sure to upload your R script on Collab. (2)

### Answer 1e
I will!


# Question 2. (Do not use R) Eruption times

Data are collected regarding the eruption times and time between eruptions for the Old Faithful Geyser, for 272 eruptions. The variables of interest are eruptions, the duration of the current eruption in minutes, and waiting, the waiting time to the next eruption in minutes. 

The following simple linear regression model is fitted:

yi = B0 + B1xi + ei where ei are i.i.d. N(0; sigma2). 

You may assume that the assumptions for a linear regression are met. The output for this question consists of some printout from R. 

## (a) What is the estimated variance of the true errors, ei, for this model? 

Why is this value also the estimated variance of the distribution of Y for given values of X? (4)

### Answer 2a

The estimated variance of the true errors is sigma-hat^2 == 5.914^2
```{r q2a1}

eivar = 5.914^2
eivar

```
The estimated variance of the true errors is: **34.9754**

**Why is this value also the estimated variance of the distribution of Y for given values of x?**

Given yi = B0 + B1xi + ei, B0 is a constant, and for a given x, B1xi is constant, so the variance of yi, must be based on the variance of ei.


## (b) Based on the output, construct the corresponding ANOVA table for this model.

Be sure to show all relevant calculations. (6)

DF-Regression = 1

DF-Residual/Error = n-2 = 272 - 2 = **270**

DF-Total = n-1 = 272 - 1 = **271**

seB1-hat = .3148

MS-Residual = 5.914^2 = **34.9754** == sigma^2 

and

SS-Residual = MS-Residual * (n-2) = 34.9754 * 270 == **9443.358**

and

R2 = 0.8115

R2 = 1 - (SS-E / SS-T)

SS-T = 9443.358 / (1 - 0.8115) = **50097.3899**

SS-R = SS-T - SS-E = **40654.0319**

and 

MS-Regression = SS-R / 1 = **40654.0319**

and 

F-stat = MS-R / MS-res = 40654.0319 / 34.9754 = **1162.3607**


| Source of Variation   | DF      | SS    |  MS                   | F-stat    |

|:---:|:---:|:---:|:---:|:---:|:---:|

| Regression            | 1       | **40654.0319** | **40654.0319** | **1162.3607** | 
| Error                 | **270** | **9443.358**  | **34.9754**   | ***       |
| Total                 | **271** | **50097.3899**  | ***           | ***
```{r}
67247.4268 / 34.9754
```


## (c) A researcher believes ...

that the expected waiting time for the next eruption increases by more than 10 minutes per minute increase in the current eruption.

Carry out a corresponding hypothesis test to test this belief. Be sure to state your null and alternative hypotheses, calculate your test statistic, and state your conclusion in context. (8)

**2c Work**

H0: B1 = 10
Ha: B1 > 10

**Hypothesis Test**
H0: B1 = 10 # checking for a specific value of B1, not just B1 = 0
H0: B1 > 10 # one-sided test

Need to run the test.

**Test Statistic**
t0 = (10.7296 - 10) / .3148
```{r q2c1}
t0 = (10.7296 - 10) / .3148
t0
```
Compare to critical value
```{r q2c1}

critvalueq2c = qt(.95,270) # one-sided, so use .95 instead of .975 which we would use for a two-sided test
critvalueq2c

```
2.3177 is greater than 1.6505, so we reject the null hypothesis. There is evidence that the population slope is greater than 10.

**There is evidence that the expected waiting time for the next eruption is greater than 10 minutes per minute increase in the current eruption.**


## (d) The 95% confidence interval ...
for the mean time to next eruption for current eruptions lasting 4.5 minutes is (80.8134, 82.7022) minutes. 

Compute the corresponding 95% prediction interval for the time to next eruption if the next eruption lasts 4.5 minutes. (6)

**2d Work**

NEED TO DO!!!

# Question 3 (Do not use R) 
An experiment is conducted to study the relationship between the speed of a car, in miles per hour (mph), and its stopping distance, in feet (ft). It is proposed to study this relationip using a simple linear regression model, Y = B0+B1X+e. Using least squares, the estimators of the regression coeficients are

.....


The output for this question consists of some printout from R: scatterplot of Y against X, the residual plot, and a plot of the prole log-likelihoods for the parameter, lambda, of the Box-Cox power transformation.

One property of the residuals is that

(1)
sum of residuals = 0


## (a) Based only on property (1), what should we expect to see in a residual plot (plot of residuals against fitted values)? (2)






## (b) Based only on property (1), what should we expect to see in a scatterplot of Y against X? (2)



## (c) Based on the output, comment on ...
whether, and how (if necessary), you would transform the response variable or the predictor, or both. Be sure to address what the scatterplot, the residual plot, and the plot of the prole log-likelihoods of the Box-Cox transformation are informing you regarding the need to transform any of the variables. (4)
