---
title: "Module09GuidedQs"
author: "Diana McSpadden"
date: "10/27/2020"
output: html_document
---
# Stat 6021: Guided Question Set 9


The Western Collaborative Group Study (WCGS) is one of the earliest studies regarding
heart disease. Data were collected from 3154 middle-aged males in California. Download
the file "wcsg.csv" and load it into R. We will focus on predicting the likelihood of getting
a heart attack based on the following predictors:

* age. Age in years
* sbp. Systolic blood pressure in mm Hg
* dbp. Diastolic blood pressure in mm Hg
* ncigs. Number of cigarettes smoked per day, on average.

The response variable is **chd69**, with a `1' indicating the person developed coronary heart
disease, and a `0' indicating the person did not develop coronary heart disease.
```{r}
# load the data

data<-read.csv("wcgs.csv", header=TRUE)
attach(data)
```

## Question 1
Before fitting a model, create some graphical summaries to see if there is a difference in
the distributions of the predictors among people who did and did not develop coronoray
heart disease. To create a boxplot, type boxplot(age~chd69) to see the distribution
of the variable age differs between people who did and did not develop coronary heart
disease. Create similar boxplots for the other variables. Which variables seem to
differentiate those who developed and did not develop coronary heart disease?

```{r}

boxplot(age~chd69)

boxplot(sbp~chd69)

boxplot(dbp~chd69)

boxplot(ncigs~chd69)
```
From the box plots age and ncigs seem to matter.

## 2. Use R to fit the logistic regression model using all the predictors listed above, and write the estimated logistic regression equation.

```{r q2-1}

result<-glm(chd69 ~ age + ncigs + sbp + dbp, family = "binomial")
summary(result)

# knowns
n <- 3154
p <- 5

```

E(y) = exp(-9.12 + (0.0666 * age) + (0.0242 * ncigs) + (0.019 * sbp) + (0.008 * dbp)) / ( 1 + exp(-9.12 + (0.0666 * age) + (0.0242 * ncigs) + (0.019 * sbp) + (0.008 * dbp)))





